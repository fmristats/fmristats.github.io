

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Modelling the data and not the images in FMRI &mdash; fmristats 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting to know fmristats" href="tutorials/getting-started.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="#" class="icon icon-home"> fmristats
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/getting-started.html">Getting to know fmristats</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/study-interface.html">Analysing multiple subjects</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/subject-remove-non-brain-areas.html">Subject analysis: Prune a statistics field from non-brain areas</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/subject-inference-at-one-point.html">Subject analysis: Inference at a single coordinate</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-preliminaries.html">Population inference: Create a sample for further analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-confirmative.html">Population inference: Confirmation study</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-explorative.html">Population inference: Exploratory study</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-covariates.html">Population inference: How to adjust for covariates</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/thresholding.html">Thresholding</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/run-on-server.html">Run the analysis on a server</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/notes.html">Some notes on speed</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">fmristats</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Modelling the data and not the images in FMRI</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="modelling-the-data-and-not-the-images-in-fmri">
<h1>Modelling the data and not the images in FMRI<a class="headerlink" href="#modelling-the-data-and-not-the-images-in-fmri" title="Permalink to this headline">¶</a></h1>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p><strong>Everything new in 0.1.0:</strong> Well, not everything but well enough to
justify a version increase.</p>
<ul class="simple">
<li>Most importantly, fmristats is a lot faster than before. You may
now expect the calculations to be finished in around 4h.</li>
<li>The API now consistently builds around the <em>study instance</em> that
has been introduced in 0.0.4. This makes the whole user interface
much more streamlined and, well, consistent. To get an idea of the
changes, please have a look at the <a class="reference internal" href="tutorials/getting-started.html#getting-started"><span class="std std-ref">Getting to know fmristats</span></a> and
<a class="reference internal" href="tutorials/study-interface.html#study-interface"><span class="std std-ref">Analysing multiple subjects</span></a> chapters.</li>
<li>Last but not least, the documentation has been polished a lot.</li>
</ul>
<p class="last">Unfortunately, version 0.1.0 is <em>not</em> backwards compatible with
versions &lt;0.1.0. Please upgrade to the most recent version.</p>
</div>
<div class="section" id="what-is-it">
<h2>What is it?<a class="headerlink" href="#what-is-it" title="Permalink to this headline">¶</a></h2>
<p>This is the first statistical software tool which implements the <a class="reference external" href="https://arxiv.org/abs/1809.07232v1">model
based</a> (MB) estimator for functional magnetic resonance imaging (FMRI)
data models. It is a new and original method for the statistical
analysis of FMRI of brain scans. MB estimation combines all
preprocessing steps of standard approaches into one modelling step.
Without altering the original 4D-image, the method results in smooth
fits of the underlying parameter fields. More importantly, the method
yields a trustworthy estimate of the uncertainty in BOLD effect
estimation.</p>
</div>
<div class="section" id="why-should-i-care">
<h2>Why should I care?<a class="headerlink" href="#why-should-i-care" title="Permalink to this headline">¶</a></h2>
<p>Current approaches to the analysis of FMRI data apply various
preprocessing steps to the original FMRI. These preprocessings lead to a
general underestimation of residual variance in the downstream analysis.
This negatively impacts the type I error of statistical tests and
increases the risk for reporting false positive results.</p>
<p>In contrast to standard approaches, MB estimation yields sound
statistical estimates for the uncertainty in BOLD effect estimation. The
availability of these uncertainty fields allows to model FMRI studies by
random effects meta regression models, acknowledging that individual
subjects are random entities, and that the certainty at which the
individual BOLD effect can be estimated from an FMRI varies across the
brain and between subjects.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please note that this is not the MATLAB program <a class="reference external" href="http://www.math.mcgill.ca/keith/fmristat/">fmristat</a> nor is it
a reimplementation of the software. <a class="reference external" href="http://www.math.mcgill.ca/keith/fmristat/">fmristat</a> (now also part of
<a class="reference external" href="https://github.com/SIMEXP/niak">niak</a>) remains the reference implementation of Keith Worsley’s
<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1053811901909334">methods</a>. Instead, this software contains an implementation of
Möbius’ <a class="reference external" href="https://arxiv.org/abs/1809.07232v1">MB estimator</a>.</p>
</div>
<p>MB estimation also encourages to process and report BOLD effects in ATI
units. In particular multicentre studies gain power by its use. For more
details, have a look at the chapter <a class="reference internal" href="tutorials/population-inference-preliminaries.html#population-ati"><span class="std std-ref">Population inference: Create a sample for further analysis</span></a>.</p>
<div class="section" id="how-to-cite-estimator-and-software">
<h3>How to cite estimator and software<a class="headerlink" href="#how-to-cite-estimator-and-software" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://arxiv.org/pdf/1809.07232v1.pdf">Reference publication</a> for the MB estimator is:</p>
<blockquote>
<div><p>Thomas W. D. Möbius (2018) <a class="reference external" href="https://arxiv.org/abs/1809.07232v1">Modelling the data and not the images in
FMRI</a>, ArXiv e-prints, arXiv:1809.07232</p>
<p>Thomas W. D. Möbius (2018) fmristats: Modelling the data and not the
images in FMRI (0.1.0) [Computer program]. Available at
<a class="reference external" href="http://fmristats.github.io/">http://fmristats.github.io/</a></p>
</div></blockquote>
<p>Thank you for using and citing this software (BibTeX:
<a class="reference download internal" href="_downloads/references.bib" download=""><code class="xref download docutils literal notranslate"><span class="pre">references.bib</span></code></a>).</p>
</div>
<div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>An easy way to install fmristats is to first install <a class="reference external" href="https://docs.anaconda.com/anaconda/install/">Anaconda3</a> and then
to use <a class="reference external" href="https://pypi.python.org/pypi/pip/">pip</a> to install fmristats itself. <a class="reference external" href="https://docs.anaconda.com/anaconda/install/">Anaconda3</a> is a cross platform
distribution for data analysis and scientific computing. <a class="reference external" href="https://pypi.python.org/pypi/pip/">pip</a> is the
“PyPA recommended tool for installing Python packages”.</p>
<p>After installation of <a class="reference external" href="https://docs.anaconda.com/anaconda/install/">Anaconda3</a> run:</p>
<div class="code shell highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="n">pip</span> <span class="n">numba</span> <span class="n">numpy</span> <span class="n">scipy</span> <span class="n">matplotlib</span> \
    <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span> <span class="n">scikit</span><span class="o">-</span><span class="n">image</span> \
    <span class="n">pandas</span> <span class="n">statsmodels</span> <span class="n">seaborn</span>

<span class="n">pip</span> <span class="n">install</span> <span class="n">fmristats</span>
</pre></div>
</div>
<p>That’s it. You should be good to go.</p>
<p>If you are planing to use the fmristats wrappers to <a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/">FSL</a> and <a class="reference external" href="http://stnava.github.io/ANTs/">ANTS</a>,
please make sure that the respective command line tools are within your
PATH.</p>
</div>
<div class="section" id="tutorials">
<h3>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h3>
<p>Tutorials discussing various parts of fmristats; expect this list to
grow.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/getting-started.html">Getting to know fmristats</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/getting-started.html#stimulus-files">1. Stimulus files</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/getting-started.html#session-files">2. Session files</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/getting-started.html#reference-maps">3. Reference maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/getting-started.html#population-maps">4. Population maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/getting-started.html#fit-the-signal-model">5. Fit the signal model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/getting-started.html#remove-non-brain-areas">6. Remove non-brain areas</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/getting-started.html#example-analysing-a-single-subject">Example: Analysing a single subject</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/study-interface.html">Analysing multiple subjects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/study-interface.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/study-interface.html#creating-a-study-instance-for-multiple-subjects">Creating a study instance for multiple subjects</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/study-interface.html#handling-subject-covariates">Handling subject covariates</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/study-interface.html#defining-subsamples">Defining subsamples</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/study-interface.html#including-a-template-in-standard-space-in-the-study-instance">Including a template in standard space in the study instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/study-interface.html#faq-i-have-only-recorded-the-date-but-not-the-time-of-my-fmri-sessions">FAQ: I have only recorded the date but not the time of my FMRI sessions</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/study-interface.html#example-analysing-multiple-subjects">Example: Analysing multiple subjects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/subject-remove-non-brain-areas.html">Subject analysis: Prune a statistics field from non-brain areas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/subject-remove-non-brain-areas.html#fitting-a-brain-mask-fmriprune">Fitting a brain mask: fmriprune</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/subject-remove-non-brain-areas.html#fitting-a-brain-mask-fsl4prune">Fitting a brain mask: fsl4prune</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/subject-remove-non-brain-areas.html#fitting-a-brain-mask-python">Fitting a brain mask: Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/subject-inference-at-one-point.html">Subject analysis: Inference at a single coordinate</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/subject-inference-at-one-point.html#create-the-model">Create the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/subject-inference-at-one-point.html#query-information">Query information</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/subject-inference-at-one-point.html#fit-the-model">Fit the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/subject-inference-at-one-point.html#select-the-highest-peak-in-the-t-field">Select the highest peak in the t-field</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/subject-inference-at-one-point.html#create-a-scatter-plot-of-fmri-data-around-a-coordinate">Create a scatter plot of FMRI data around a coordinate</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/subject-inference-at-one-point.html#fit-different-models-to-the-data-at-the-coordinate">Fit different models to the data at the coordinate</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/subject-inference-at-one-point.html#plot-the-fitted-regression-surfaces">Plot the fitted regression surfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/subject-inference-at-one-point.html#formal-testing">Formal testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-preliminaries.html">Population inference: Create a sample for further analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-preliminaries.html#the-ati-reference-field">The ATI reference field</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-preliminaries.html#create-the-sample-for-your-study">Create the sample for your study</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-confirmative.html">Population inference: Confirmation study</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-confirmative.html#load-data-and-fit-the-population-model">Load data and fit the population model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-confirmative.html#extract-the-knapp-hartung-adjusted-t-statistics-field">Extract the Knapp-Hartung adjusted t-statistics field</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-confirmative.html#create-a-forest-plot-of-bold-statistics">Create a forest plot of BOLD statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-confirmative.html#create-a-funnel-plot-of-bold-statistics">Create a funnel plot of BOLD statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-confirmative.html#formal-testing">Formal testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-explorative.html">Population inference: Exploratory study</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-explorative.html#load-data-and-fit-the-population-model">Load data and fit the population model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-explorative.html#extract-the-knapp-hartung-adjusted-t-statistics-field">Extract the Knapp-Hartung adjusted t-statistics field</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-explorative.html#select-the-highest-peak-in-the-t-field">Select the highest peak in the t-field</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-explorative.html#create-a-forest-plot-of-bold-statistics">Create a forest plot of BOLD statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-explorative.html#create-a-funnel-plot-of-bold-statistics">Create a funnel plot of BOLD statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/population-inference-explorative.html#formal-testing">Formal testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-covariates.html">Population inference: How to adjust for covariates</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/thresholding.html">Thresholding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/thresholding.html#some-notation">Some notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/thresholding.html#load-statistics">Load statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/thresholding.html#strategies-for-thresholding">Strategies for thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/thresholding.html#get-summary-statistics">Get summary statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/thresholding.html#plotting-fields-above-a-threshold">Plotting fields above a threshold</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/thresholding.html#effects-coordinates-locations">Effects, coordinates, locations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/thresholding.html#introducing-the-fmri-fountain">Introducing: the FMRI fountain</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/run-on-server.html">Run the analysis on a server</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/notes.html">Some notes on speed</a></li>
</ul>
</div>
</div>
<div class="section" id="python-interface">
<h3>Python interface<a class="headerlink" href="#python-interface" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-fmristats.affines">Affine transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-fmristats.session">The FMRI Session</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-fmristats.reference">The Reference Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-fmristats.pmap">The Population Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-fmristats.diffeomorphisms">The Population Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-fmristats.smodel">The FMRI Signal Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-fmristats.sample">The Sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html#module-fmristats.pmodel">The FMRI Population Model</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h3>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorials/getting-started.html" class="btn btn-neutral float-right" title="Getting to know fmristats" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2018, Thomas W. D. Möbius

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'0.1.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>