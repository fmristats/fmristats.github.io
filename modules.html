

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Modules &mdash; fmristats 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="What is new" href="new.html" />
    <link rel="prev" title="Some notes on speed" href="tutorials/notes.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> fmristats
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/getting-started.html">Getting to know fmristats</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/study-interface.html">Analysing multiple subjects</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/subject-remove-non-brain-areas.html">Subject analysis: Prune a statistics field from non-brain areas</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/subject-inference-at-one-point.html">Subject analysis: Inference at a single coordinate</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-preliminaries.html">Population inference: Create a sample for further analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-confirmative.html">Population inference: Confirmation study</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-explorative.html">Population inference: Exploratory study</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/population-inference-covariates.html">Population inference: How to adjust for covariates</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/thresholding.html">Thresholding</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/run-on-server.html">Run the analysis on a server</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/notes.html">Some notes on speed</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-fmristats.affines">Affine transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fmristats.session">The FMRI Session</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fmristats.reference">The Reference Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fmristats.pmap">The Population Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fmristats.diffeomorphisms">The Population Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fmristats.smodel">The FMRI Signal Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fmristats.sample">The Sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fmristats.pmodel">The FMRI Population Model</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="new.html">What is new</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">fmristats</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Modules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/modules.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-fmristats.affines">
<span id="affine-transformations"></span><h2>Affine transformations<a class="headerlink" href="#module-fmristats.affines" title="Permalink to this headline">¶</a></h2>
<p>Defines classes for affine transformations, rigid body transformations,
and orthonormal transformations, and functions for manipulating and
calculating inverses of affine transformations.</p>
<dl class="class">
<dt id="fmristats.affines.Affine">
<em class="property">class </em><code class="descclassname">fmristats.affines.</code><code class="descname">Affine</code><span class="sig-paren">(</span><em>affine</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affine" title="Permalink to this definition">¶</a></dt>
<dd><p>An affine transformation</p>
<p>Affine transformations are stored in homologous coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>affine</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>4</em><em>,</em><em>4</em><em>)</em>) – An affine transformation in homologous coordinates.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fmristats.affines.Affine.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affine.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply affine transformation</p>
<p>Will apply the affine transformation to the matrix or vector x.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>) or </em><em>(</em><em>..</em><em>,</em><em>3</em><em>)</em>) – Vector or matrix of (row) vectors.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The result of the affine applied to the matrix (or vector)
x, in particular, it will be of the same shape.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affine.apply_to_index">
<code class="descname">apply_to_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affine.apply_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply affine transformation to index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>3-tuple</em>) – 3-tuple of int</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The result of the affine applied to the index.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affine.apply_to_indices">
<code class="descname">apply_to_indices</code><span class="sig-paren">(</span><em>indices</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affine.apply_to_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply affine transformation to indices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>3-tuple</em>) – 3-tuple of Slice or Ellipse objects.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The result of the affine applied to the indices.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affine.aspect">
<code class="descname">aspect</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affine.aspect" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>int</em><em>, </em><em>either 0</em><em>,</em><em>1</em><em>,</em><em>2</em>) – x</li>
<li><strong>y</strong> (<em>int</em><em>, </em><em>either 0</em><em>,</em><em>1</em><em>,</em><em>2</em>) – y</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The aspect ratio of the respected resolution.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affine.dot">
<code class="descname">dot</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affine.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix multiplication with x</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a><em> or </em><a class="reference internal" href="#fmristats.affines.Affines" title="fmristats.affines.Affines"><em>Affines</em></a>) – An affine transformation.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Output has the same type as x.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#fmristats.affines.Affines" title="fmristats.affines.Affines">Affines</a> or <a class="reference internal" href="#fmristats.affines.Affines" title="fmristats.affines.Affines">Affines</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affine.euler">
<code class="descname">euler</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affine.euler" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Euler angles</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affine.inv">
<code class="descname">inv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affine.inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the inverse of an affine transformation</p>
<p>If the affine transformation is rigid, i.e., of the form A⋅x + b
with A being a rotation matrix, then a more numerical stable
algorithm for calculating the inverse is used than otherwise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">The inverse of the affine transformation.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affine.resolution">
<code class="descname">resolution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affine.resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolution</p>
<p>The resolution is the length of the base vectors (1,0,0),
(0,1,0), and (0,0,1) after being mapped to by this affine
transformations. The length of <code class="docutils literal notranslate"><span class="pre">A⋅b</span></code>, for <code class="docutils literal notranslate"><span class="pre">A</span></code> being this
affine transformation and <code class="docutils literal notranslate"><span class="pre">b</span></code> being one of the three basis
vectors is the norm of <code class="docutils literal notranslate"><span class="pre">A⋅b</span> <span class="pre">-</span> <span class="pre">A⋅0</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affine.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affine.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save instance to disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – A file name.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affine.volume">
<code class="descname">volume</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affine.volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Volume of the parallelepiped spanned by the image of the
canonical basis</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fmristats.affines.Affines">
<em class="property">class </em><code class="descclassname">fmristats.affines.</code><code class="descname">Affines</code><span class="sig-paren">(</span><em>affines</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affines" title="Permalink to this definition">¶</a></dt>
<dd><p>Affine transformations</p>
<p>Affine transformations are stored in homologous coordinates.</p>
<dl class="method">
<dt id="fmristats.affines.Affines.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affines.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply affine transformations to a vector</p>
<p>Will apply the affine transformations to the vector x.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em>) – Vector to which the affine transformations are applied</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">The result of the affine transformations applied to x.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affines.apply_to_index">
<code class="descname">apply_to_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affines.apply_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply affine transformation to index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>3-tuple</em>) – 3-tuple of int</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The result of the affine applied to the index.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affines.dot">
<code class="descname">dot</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affines.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix multiplication (a.k.a. dot product) with the affines
transformation x</p>
<p>This will performe a matrix multiplication of each affine
transformation with x.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a>) – An affine transformation.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">The result of the calculation is again of type Affines.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affines.euler">
<code class="descname">euler</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affines.euler" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Euler angles for all affine transformations</p>
<p class="rubric">Notes</p>
<p>This only makes sense, if the affine transformations are rigid.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affines.inv">
<code class="descname">inv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affines.inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the inverse of an affine transformation</p>
<p>If the affine transformation is rigid, i.e., of the form A⋅x + b
with A being a rotation matrix, then a more numerical stable
algorithm for calculating the inverse is used than otherwise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">The inverse of the affine transformation.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affines.mean">
<code class="descname">mean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affines.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean affine transformation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The mean affine transformation.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine">Affine</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Some basic non-Euclidean statistics is used here.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affines.mean_rigid">
<code class="descname">mean_rigid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affines.mean_rigid" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean rigid transformation of rigid
transformations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The mean rigid affine transformation.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine">Affine</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Some basic non-Euclidean statistics is used here.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affines.mean_within_windows">
<code class="descname">mean_within_windows</code><span class="sig-paren">(</span><em>r=0</em>, <em>skip=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affines.mean_within_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean rigid transformation of the rigid
transformation within a window of [-r,r] around each
transformation.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.affines.Affines.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.Affines.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save instance to disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – A file name.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="fmristats.affines.is_rotation_matrix">
<code class="descclassname">fmristats.affines.</code><code class="descname">is_rotation_matrix</code><span class="sig-paren">(</span><em>a</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.is_rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if a 3x3-matrix is a rotation matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n</em><em>,</em><em>n</em><em>)</em>) – an darray</li>
<li><strong>**kwargs</strong> – parameters passed on to <cite>np.close</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True or False.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The function assumes that <cite>a</cite> is square.</p>
</dd></dl>

<dl class="function">
<dt id="fmristats.affines.isclose">
<code class="descclassname">fmristats.affines.</code><code class="descname">isclose</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.isclose" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if two affines are close to each other</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a>) – an affine transformation.</li>
<li><strong>y</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a>) – an affine transformation.</li>
<li><strong>**kwargs</strong> – parameters passed on to <cite>np.close</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True or False.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fmristats.affines.isinverse">
<code class="descclassname">fmristats.affines.</code><code class="descname">isinverse</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.affines.isinverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if two affines are inverses of each other</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a>) – an affine transformation.</li>
<li><strong>y</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a>) – an affine transformation.</li>
<li><strong>**kwargs</strong> – parameters passed on to <cite>np.close</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True or False.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-fmristats.session">
<span id="the-fmri-session"></span><h2>The FMRI Session<a class="headerlink" href="#module-fmristats.session" title="Permalink to this headline">¶</a></h2>
<p>Defines a class for FMRI sessions, which allows to define the
experimental setting and design, and to set up necessary parameters
needed for the statistical analysis of single subject data.</p>
<dl class="class">
<dt id="fmristats.session.Session">
<em class="property">class </em><code class="descclassname">fmristats.session.</code><code class="descname">Session</code><span class="sig-paren">(</span><em>name</em>, <em>data</em>, <em>epi_code</em>, <em>spacial_resolution</em>, <em>temporal_resolution</em>, <em>reference</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.session.Session" title="Permalink to this definition">¶</a></dt>
<dd><p>A FMRI session</p>
<p>Collects attributes which reasonably define a FMRI
session, e.g., experimental design, the on- and offsets of the
blocks or events of the paradigm, the observed FMRI signals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>Identifier</em>) – The name or of the FMRI experiment</li>
<li><strong>data</strong> (<em>array</em><em>, </em><em>shape</em><em> (</em><em>t</em><em>,</em><em>x</em><em>,</em><em>y</em><em>,</em><em>z</em><em>)</em>) – The data of observations, where t is the number of scan
cycles</li>
<li><strong>epi_code</strong> (<em>int</em>) – Coded EPI sequence, either one of -3, -2, -1, 1, 2, 3</li>
<li><strong>spacial_resolution</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – Spacial resolution of the image</li>
<li><strong>temporal_resolution</strong> (<em>float</em>) – Temporal resolution of the image</li>
<li><strong>reference</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a><em> or </em><em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>4</em><em>,</em><em>4</em><em>)</em><em>, </em><em>dtype: float</em>) – The scanner reference</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fmristats.session.Session.descriptive_statistics">
<code class="descname">descriptive_statistics</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.session.Session.descriptive_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Descriptive statistics for assessing the quality of the
MR-signal on scan cycle level.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.session.Session.descriptive_statistics_detailed">
<code class="descname">descriptive_statistics_detailed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.session.Session.descriptive_statistics_detailed" title="Permalink to this definition">¶</a></dt>
<dd><p>Descriptive statistics for assessing the quality of the
MR-signal on scan level.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.session.Session.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.session.Session.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model instance to disk</p>
<p>This will save the current model instance to disk for later use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – File name.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.session.Session.set_slice_timing">
<code class="descname">set_slice_timing</code><span class="sig-paren">(</span><em>slice_timing=None</em>, <em>interleaved=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.session.Session.set_slice_timing" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the slice time information</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>slice_timing</strong> (<em>ndarray of float</em><em>, </em><em>shape</em><em> (</em><em>n</em><em>,</em><em>) or </em><em>(</em><em>n</em><em>,</em><em>x</em><em>,</em><em>y</em><em>,</em><em>z</em><em>)</em>) – The time vector indicating the point in time at which a
given slice of the acquisition grid has been measured.  If
slice_timing has shape (n,), all slices of a scan cycle are
assumed to have been measured during the same time.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.session.Session.set_stimulus">
<code class="descname">set_stimulus</code><span class="sig-paren">(</span><em>stimulus</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.session.Session.set_stimulus" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the stimulus</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="fmristats.session.create_slice_timing">
<code class="descclassname">fmristats.session.</code><code class="descname">create_slice_timing</code><span class="sig-paren">(</span><em>shape</em>, <em>epi_code</em>, <em>temporal_resolution</em>, <em>interleaved=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.session.create_slice_timing" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a time vector from parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>shape</strong> (<em>tuple</em><em>, </em><em>type: int</em>) – </li>
<li><strong>epi_code</strong> (<em>int</em><em> or </em><em>None</em>) – </li>
<li><strong>temporal_resolution</strong> (<em>float</em>) – The temporal resolution.</li>
<li><strong>interleaved</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The time vector that holds the slices time information. The
vector holds the start point of the time at which a particular
slice has been measured.  If ep is None, slice_time has
shape (M,) with M equal to the number of full scan cycles.  If
ep is int, then slice_time has
the same shape as the data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray of float, shape (M,) or (M,N,O,P)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fmristats.session.fmrisetup">
<code class="descclassname">fmristats.session.</code><code class="descname">fmrisetup</code><span class="sig-paren">(</span><em>session</em>, <em>stimulus</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.session.fmrisetup" title="Permalink to this definition">¶</a></dt>
<dd><p>If a session instance was created using the basic information in a
Nifti1 file, this will complete the set-up of the session by
providing the rest of the necessary FMRI session information:
stimulus design (a.k.a paradigm).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>session</strong> (<a class="reference internal" href="#fmristats.session.Session" title="fmristats.session.Session"><em>Session</em></a>) – </li>
<li><strong>stimulus</strong> (<em>Stimulus</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-fmristats.reference">
<span id="the-reference-maps"></span><h2>The Reference Maps<a class="headerlink" href="#module-fmristats.reference" title="Permalink to this headline">¶</a></h2>
<p>Subjects may tend to move their head in the scanner ever so slightly,
which means that the tilt and position of the head during the FMRI
session may change over time. For this reason, we need to track the
subject head in the scanner, i.e. we need to find and estimate its tilt
and position at a given time point. Mathematically, head movements are
affine transformations (rigid body transformations) that map from a
space with a subject-specific coordinate system to the scanner space (or
in other words from a coordinate system that is fixed with respect to
the subject to a coordinate system that is fixed with respect to the
scanner). The <em>subject reference space</em> will always be denoted by
<span class="math notranslate nohighlight">\(R\)</span>, and the scanner space by <span class="math notranslate nohighlight">\(S\)</span>. We may then identify head
movements with the maps:</p>
<div class="math notranslate nohighlight">
\[ρ_t : R \to S.\]</div>
<p>These maps will be called reference maps: <span class="math notranslate nohighlight">\(ρ_t\)</span> is called the
<em>reference map of scan</em> <span class="math notranslate nohighlight">\(t\)</span>. Reference maps <span class="math notranslate nohighlight">\(ρ_t\)</span> are
functions that map from subject reference space to the location and
orientation of the subject brain in the scanner at a given time point.</p>
<p>The inverse of <span class="math notranslate nohighlight">\(ρ_t\)</span> is called the <em>acquisition map of scan</em>
<span class="math notranslate nohighlight">\(t\)</span>:</p>
<div class="math notranslate nohighlight">
\[ρ_t^{-1} : S \to R.\]</div>
<p>Hence, the acquisition map of scan <span class="math notranslate nohighlight">\(t\)</span> maps from scanner space to
subject reference space.</p>
<dl class="class">
<dt id="fmristats.reference.ReferenceMaps">
<em class="property">class </em><code class="descclassname">fmristats.reference.</code><code class="descname">ReferenceMaps</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.reference.ReferenceMaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Reference maps are functions that map from the subject reference
space to the location and orientation of the subject brain in the
scanner at a given time point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>Identifier</em>) – The identifier of the subject</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fmristats.reference.ReferenceMaps.describe">
<code class="descname">describe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.reference.ReferenceMaps.describe" title="Permalink to this definition">¶</a></dt>
<dd><p>Give a description of the instance</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.reference.ReferenceMaps.descriptive_statistics">
<code class="descname">descriptive_statistics</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.reference.ReferenceMaps.descriptive_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Give descriptive statistics of the instance</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.reference.ReferenceMaps.detect_outlying_scans">
<code class="descname">detect_outlying_scans</code><span class="sig-paren">(</span><em>sgnf</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.reference.ReferenceMaps.detect_outlying_scans" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect outlying scans</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sgnf</strong> (<em>float</em>) – Significance level at which a test for the existence of a
outlier is tested.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if the particular full scan cycle is considered an outlier.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray of bool</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Uses the eigenvalues of the pcm method for outlier detection.
(Currently only full scan cycles supported.)</p>
<p>The algorithm will mark scan cycles as False which have
eigenvalues which differ significantly from the eigenvalues all
other scan cycles, as this likely is the result of severe head
movement during the measurement of this cycle.</p>
<p>Grubbs’ test is used recursively for the outlier detection. The
norm of all three semi axis length and each single semi axis
length is tested for outlier separately.</p>
<p>It should simply give you an idea on how severe head movements
might have been, and allow you to remove the most obvious
outliers.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.reference.ReferenceMaps.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>session</em>, <em>use_raw=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.reference.ReferenceMaps.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit head movement</p>
<p>This will fit rigid body transformations to the data, i.e. it
will estimate the position and bearing of the head in each scan
cycle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>session</strong> (<a class="reference internal" href="#fmristats.session.Session" title="fmristats.session.Session"><em>Session</em></a>) – The FMRI session data of the subject.</li>
<li><strong>use_raw</strong> (<em>bool</em>) – Use the raw data or only the data in the foreground.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The function implements a principle axis method for rigid body
tracking.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.reference.ReferenceMaps.reset_reference_space">
<code class="descname">reset_reference_space</code><span class="sig-paren">(</span><em>x=None</em>, <em>cycle=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.reference.ReferenceMaps.reset_reference_space" title="Permalink to this definition">¶</a></dt>
<dd><p>This will reset the coordinates system of the reference space</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>None</em><em> or </em><a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a><em> or </em><em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>4</em><em>,</em><em>4</em><em>)</em><em>, </em><em>dtype: float</em>) – An affine transformation or None (default)</li>
<li><strong>cycle</strong> (<em>None</em><em> or </em><em>int</em>) – Index of a scan cycle or None</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This will reset the coordinates system of the subject reference
space by moving origin and base vectors to the new position
specified by the transformation x. The affine transformation
<span class="math notranslate nohighlight">\(x\)</span> goes <strong>from this</strong> reference space <strong>to the new</strong>
reference space.</p>
<div class="math notranslate nohighlight">
\[x : R \to R'.\]</div>
<p>If the affine transformation has the form
x(<span class="math notranslate nohighlight">\(x\)</span>)= <span class="math notranslate nohighlight">\(Ax+b\)</span>, then <span class="math notranslate nohighlight">\(b\)</span> is the new origin and
<span class="math notranslate nohighlight">\(A\)</span> defines the new orientation.</p>
<p>If x=None, then x will be set to the inverse of the mean of the
acquisition maps. This has the consequence that the new
reference space is identical to the average position of the
subject head in the scanner. If x=None and cycle is
integer <span class="math notranslate nohighlight">\(t_0\)</span>, then <span class="math notranslate nohighlight">\(x\)</span> is set to:</p>
<div class="math notranslate nohighlight">
\[x = ρ_{t_0}.\]</div>
<p>This has the consequence that the new subject reference space
equals the position of the subject head during scan cycle
<span class="math notranslate nohighlight">\(t_0\)</span>.</p>
<p>References maps are the maps <span class="math notranslate nohighlight">\(ρ_t\)</span> which map from subject
reference space to scanner:</p>
<div class="math notranslate nohighlight">
\[ρ_t : R \to S.\]</div>
<p>Acquisition maps are the inverses of the maps <span class="math notranslate nohighlight">\(ρ_t\)</span> and
map from scanner space to subject reference space:</p>
<div class="math notranslate nohighlight">
\[ρ_t^{-1} : S \to R.\]</div>
<p>The new subject reference space <span class="math notranslate nohighlight">\(R'\)</span> is equal to
<span class="math notranslate nohighlight">\(R':=x[R]\)</span>, and the new acquisition maps are therefore:</p>
<div class="math notranslate nohighlight">
\[ρ_t^{'-1} = x ∘ ρ^{-1}_t\]</div>
<p>Then:</p>
<div class="math notranslate nohighlight">
\[ρ'_t : R' \to S\]</div>
<p><strong>Warning</strong>: Resetting the reference space makes all population
maps which have been defined for this subject reference space
obsolete. You should thus perform this operation prior to
fitting any population maps.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.reference.ReferenceMaps.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.reference.ReferenceMaps.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save instance to disk</p>
<p>This will save the instance to disk for later use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – File name.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.reference.ReferenceMaps.set_acquisition_maps">
<code class="descname">set_acquisition_maps</code><span class="sig-paren">(</span><em>maps</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.reference.ReferenceMaps.set_acquisition_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>The subject reference space of the fMRI experiment</p>
<p>This will define the subject reference space of an FMRI
experiment.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>maps</strong> (<a class="reference internal" href="#fmristats.affines.Affines" title="fmristats.affines.Affines"><em>Affines</em></a><em> or </em><em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n</em><em>,</em><em>4</em><em>,</em><em>4</em><em>)</em><em>, </em><em>dtype: float</em>) – Acquisition maps. Rigid body transformations that
map from scanner space to subject reference space.</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The subject reference space is uniquely defined by these
affine transformations.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fmristats.pmap">
<span id="the-population-space"></span><h2>The Population Space<a class="headerlink" href="#module-fmristats.pmap" title="Permalink to this headline">¶</a></h2>
<p>A population map is a diffeomorphism from a population space to the
subject reference space of a FMRI session.</p>
<dl class="class">
<dt id="fmristats.pmap.PopulationMap">
<em class="property">class </em><code class="descclassname">fmristats.pmap.</code><code class="descname">PopulationMap</code><span class="sig-paren">(</span><em>diffeomorphism</em>, <em>vb=None</em>, <em>nb=None</em>, <em>vb_background=None</em>, <em>nb_background=None</em>, <em>vb_estimate=None</em>, <em>nb_estimate=None</em>, <em>vb_mask=None</em>, <em>nb_mask=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.PopulationMap" title="Permalink to this definition">¶</a></dt>
<dd><p>A population map is a diffeomorphism from a population space to the
reference space of a FMRI session.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>diffeomorphism</strong> (<em>subclass of Diffeomorphism</em>) – The diffeomorphism ψ that maps from vb (the population space) to
nb (the subject space).</li>
<li><strong>vb</strong> (<em>None</em><em>, </em><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – An image in population space.</li>
<li><strong>nb</strong> (<em>None</em><em>, </em><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – An image in subject space.</li>
<li><strong>vb_background</strong> (<em>None</em><em>, </em><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – An image in population space.</li>
<li><strong>nb_background</strong> (<em>None</em><em>, </em><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – An image in subject space.</li>
<li><strong>vb_estimate</strong> (<em>None</em><em>, </em><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – An image in population space.</li>
<li><strong>nb_estimate</strong> (<em>None</em><em>, </em><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – An image in subject space.</li>
<li><strong>vb_mask</strong> (<em>None</em><em>, </em><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>array</em>) – An image in population space.</li>
<li><strong>nb_mask</strong> (<em>None</em><em>, </em><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>array</em>) – An image in subject space.</li>
<li><strong>vb_ati</strong> (<em>None</em><em>, </em><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>array</em>) – An image in population space that will serve as the reference
field for the BOLD unit.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If vb (or any of the other arguments) is an Image, it will be
checked whether its <em>reference affine</em> agrees with the reference
affine of the diffeomorphism ψ.  If vb is an ndarray, its shape must
be equal to the shape of the diffeomorphism, as it will then be
assumed that they share the same reference affine: the vb’s
reference will be set identical to the reference of the
diffeomorphism.</p>
<p>If the software which has been used to fit the diffeomorphism
creates a warped images of its inputs, they can be stored in
<cite>vb_estimate</cite> and <cite>nb_estimate</cite> respectively.</p>
<p>There appears to be no clear naming convention for images in <cite>vb</cite>
and <cite>nb</cite>. Examples for images in <cite>vb</cite> and <cite>nb</cite> are <cite>input</cite>,
<cite>target</cite>, <cite>template</cite>, <cite>reference</cite>, <cite>moving</cite>, <cite>fixed</cite>, and more: The
intuitive meaning of what these images shall represent is often (and
not always) clear from the context, but the question which of these
images live in <cite>vb</cite> or <cite>nb</cite> is ambiguous at best. Say, when fitting
a diffeomorphism providing an algorithm with the arguments
<cite>reference</cite> and <cite>input</cite> (FNIRT) or <cite>fixed</cite> and <cite>moving</cite> (ANTS): does
the diffeomorphism go from <cite>reference</cite> to <cite>input</cite> or vice versa?</p>
<dl class="method">
<dt id="fmristats.pmap.PopulationMap.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.PopulationMap.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save instance to disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – A file name.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.pmap.PopulationMap.set_nb">
<code class="descname">set_nb</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.PopulationMap.set_nb" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or reset the image in nb</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – The image or data array.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.pmap.PopulationMap.set_nb_background">
<code class="descname">set_nb_background</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.PopulationMap.set_nb_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or reset the background image in nb</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – The image or data array.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.pmap.PopulationMap.set_nb_estimate">
<code class="descname">set_nb_estimate</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.PopulationMap.set_nb_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or reset the estimate of the image in nb</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – The image or data array.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.pmap.PopulationMap.set_nb_mask">
<code class="descname">set_nb_mask</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.PopulationMap.set_nb_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or reset the estimate of the image in nb</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – The image or data array.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.pmap.PopulationMap.set_vb">
<code class="descname">set_vb</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.PopulationMap.set_vb" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or reset the image in vb</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – The image or data array.</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If image is an Image, it will be checked whether its reference
agrees with the reference of the diffeomorphism.  If image is an
ndarray, it must be equal to the shape stored with the
diffeomorphism, as it will then be assumed that they share the
same reference: the image’s reference will be set identical to
the reference of the diffeomorphism.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.pmap.PopulationMap.set_vb_ati">
<code class="descname">set_vb_ati</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.PopulationMap.set_vb_ati" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or reset the reference field for the BOLD unit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – The image or data array.</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If image is an Image, it will be checked whether its reference
agrees with the reference of the diffeomorphism.  If image is an
ndarray, it must be equal to the shape stored with the
diffeomorphism, as it will then be assumed that they share the
same reference: the image’s reference will be set identical to
the reference of the diffeomorphism.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.pmap.PopulationMap.set_vb_background">
<code class="descname">set_vb_background</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.PopulationMap.set_vb_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or reset the background image in vb</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – The image or data array.</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If image is an Image, it will be checked whether its reference
agrees with the reference of the diffeomorphism.  If image is an
ndarray, it must be equal to the shape stored with the
diffeomorphism, as it will then be assumed that they share the
same reference: the image’s reference will be set identical to
the reference of the diffeomorphism.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.pmap.PopulationMap.set_vb_estimate">
<code class="descname">set_vb_estimate</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.PopulationMap.set_vb_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or reset the estimate for the image in vb</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – The image or data array.</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If image is an Image, it will be checked whether its reference
agrees with the reference of the diffeomorphism.  If image is an
ndarray, it must be equal to the shape stored with the
diffeomorphism, as it will then be assumed that they share the
same reference: the image’s reference will be set identical to
the reference of the diffeomorphism.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.pmap.PopulationMap.set_vb_mask">
<code class="descname">set_vb_mask</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.PopulationMap.set_vb_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or reset the estimate for the image in vb</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a><em> or </em><em>ndarray</em>) – The image or data array.</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If image is an Image, it will be checked whether its reference
agrees with the reference of the diffeomorphism.  If image is an
ndarray, it must be equal to the shape stored with the
diffeomorphism, as it will then be assumed that they share the
same reference: the image’s reference will be set identical to
the reference of the diffeomorphism.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="fmristats.pmap.pmap_scanner">
<code class="descclassname">fmristats.pmap.</code><code class="descname">pmap_scanner</code><span class="sig-paren">(</span><em>session</em>, <em>reference_maps=None</em>, <em>scan_cycle=None</em>, <em>resolution=2.0</em>, <em>name='scanner'</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmap.pmap_scanner" title="Permalink to this definition">¶</a></dt>
<dd><p>The identity map</p>
<p>Sets the standard space equal to the coordinate system of the
scanner and the diffeomorphism from standard space to subject
reference space to different rigid body transformations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>session</strong> (<a class="reference internal" href="#fmristats.session.Session" title="fmristats.session.Session"><em>Session</em></a>) – A FMRI session</li>
<li><strong>reference_maps</strong> (<em>None</em><em> or </em><a class="reference internal" href="#fmristats.reference.ReferenceMaps" title="fmristats.reference.ReferenceMaps"><em>ReferenceMaps</em></a>) – Reference Maps</li>
<li><strong>scan_cycle</strong> (<em>None</em><em> or </em><em>int</em>) – Reference scan cycle.</li>
<li><strong>resolution</strong> (<em>str</em><em> or </em><em>float</em>) – Resolution (in units of the session reference, this will likely
be milli meter), default 2. If resolution is set to ‘native’ the
resolution of the scanner is used.</li>
<li><strong>= str</strong> (<em>name</em>) – A name for this population map.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>When only studying a single subject, it is possible to set the
standard space to an isometric image of the subject’s head, i.e. to
a space which preserves distances with respect to the subject.</p>
<p>In other words, for a single subject, the standard space can be
set equal to the subject reference space <span class="math notranslate nohighlight">\(R\)</span> or to
<span class="math notranslate nohighlight">\(ρ_t[R]\)</span> for any time point <span class="math notranslate nohighlight">\(t\)</span> in the Session.</p>
<p>You may even set <span class="math notranslate nohighlight">\(R\)</span> identical to <span class="math notranslate nohighlight">\(S\)</span> if scanner and
subject reference space are reasonable »close«. This may be archived
by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">reset_reference_space()</span></code> of the reference maps. If
called without arguments, this will have the effect that the
population space is then equal to the mean location of the subject
in the scanner.</p>
</dd></dl>

</div>
<div class="section" id="module-fmristats.diffeomorphisms">
<span id="the-population-map"></span><h2>The Population Map<a class="headerlink" href="#module-fmristats.diffeomorphisms" title="Permalink to this headline">¶</a></h2>
<p>Defines classes for diffeomorphisms which are not necessarily affine
transformations.</p>
<dl class="class">
<dt id="fmristats.diffeomorphisms.AffineTransformation">
<em class="property">class </em><code class="descclassname">fmristats.diffeomorphisms.</code><code class="descname">AffineTransformation</code><span class="sig-paren">(</span><em>reference</em>, <em>affine</em>, <em>shape</em>, <em>vb=None</em>, <em>nb=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.AffineTransformation" title="Permalink to this definition">¶</a></dt>
<dd><p>An affine transformation ψ mapping from a standard space <span class="math notranslate nohighlight">\(M\)</span>
to a subject reference space <span class="math notranslate nohighlight">\(R\)</span>. It is</p>
<div class="math notranslate nohighlight">
\[ψ (x) = A⋅x.\]</div>
<p>for <span class="math notranslate nohighlight">\(x∈M\)</span> and <span class="math notranslate nohighlight">\(A\)</span> an affine transformation.</p>
<p>A point [i,j,k] in the index space of the template in <span class="math notranslate nohighlight">\(M\)</span> maps
to the coordinates</p>
<div class="math notranslate nohighlight">
\[ψ(reference[i,j,k]) = A ⋅ reference[i,j,k]\]</div>
<p>in the subject reference space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reference</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a><em> or </em><em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>4</em><em>,</em><em>4</em><em>)</em>) – An affine transformation</li>
<li><strong>affine</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a><em> or </em><em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>4</em><em>,</em><em>4</em><em>)</em>) – An affine transformation</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fmristats.diffeomorphisms.AffineTransformation.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>coordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.AffineTransformation.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the point at given coordinate</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of integers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.AffineTransformation.apply_to_index">
<code class="descname">apply_to_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.AffineTransformation.apply_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the point with given index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of integers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.AffineTransformation.apply_to_indices">
<code class="descname">apply_to_indices</code><span class="sig-paren">(</span><em>indices</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.AffineTransformation.apply_to_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the points with given indices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of slices or ellipses</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fmristats.diffeomorphisms.Diffeomorphism">
<em class="property">class </em><code class="descclassname">fmristats.diffeomorphisms.</code><code class="descname">Diffeomorphism</code><span class="sig-paren">(</span><em>reference</em>, <em>shape</em>, <em>vb=None</em>, <em>nb=None</em>, <em>name=None</em>, <em>metadata=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Diffeomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>A diffeomorphism ψ from standard space to subject space</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reference</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a><em> or </em><em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>4</em><em>,</em><em>4</em><em>)</em>) – An affine transformation</li>
<li><strong>shape</strong> (<em>tuple</em>) – Shape of template data in standard space.</li>
<li><strong>vb</strong> (<em>None</em><em> or </em><em>str</em><em> or </em><em>Identifier</em>) – An object that will be used to identify the domain (vb) of this
diffeomorphism.</li>
<li><strong>nb</strong> (<em>None</em><em> or </em><em>Identifier</em>) – An object that will be used to identify the image (nb) of this
diffeomorphism.</li>
<li><strong>name</strong> (<em>None</em><em> or </em><em>str</em>) – Method that has produced this diffeomorphism.</li>
<li><strong>metadata</strong> (<em>dict</em>) – If meta data is provided which give information on which data
had been used for the fit: which had provided, should be a dict
with at least the following fields: <code class="docutils literal notranslate"><span class="pre">{'vb_file':</span>
<span class="pre">path/which/defined/the/domain,</span> <span class="pre">'nb_file':</span>
<span class="pre">path/which/defined/the/image,}</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>A reasonable subclass of Diffeomorphism must define the attributes
<a class="reference internal" href="#fmristats.diffeomorphisms.Diffeomorphism.apply_to_index" title="fmristats.diffeomorphisms.Diffeomorphism.apply_to_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_index()</span></code></a>, <a class="reference internal" href="#fmristats.diffeomorphisms.Diffeomorphism.apply_to_indices" title="fmristats.diffeomorphisms.Diffeomorphism.apply_to_indices"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_to_indices()</span></code></a>, and <a class="reference internal" href="#fmristats.diffeomorphisms.Diffeomorphism.apply" title="fmristats.diffeomorphisms.Diffeomorphism.apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply()</span></code></a>.</p>
<dl class="method">
<dt id="fmristats.diffeomorphisms.Diffeomorphism.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>coordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Diffeomorphism.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the point at given coordinate</p>
<p>This is the identity; it will return the same coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of integers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Diffeomorphism.apply_to_index">
<code class="descname">apply_to_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Diffeomorphism.apply_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the point with given index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of integers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Diffeomorphism.apply_to_indices">
<code class="descname">apply_to_indices</code><span class="sig-paren">(</span><em>indices</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Diffeomorphism.apply_to_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the points with given indices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of slices or ellipses</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Diffeomorphism.coordinates">
<code class="descname">coordinates</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Diffeomorphism.coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates in the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Diffeomorphism.coordinates_domain">
<code class="descname">coordinates_domain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Diffeomorphism.coordinates_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates in the domain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Diffeomorphism.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Diffeomorphism.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save instance to disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – A file name.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fmristats.diffeomorphisms.Displacement">
<em class="property">class </em><code class="descclassname">fmristats.diffeomorphisms.</code><code class="descname">Displacement</code><span class="sig-paren">(</span><em>reference</em>, <em>displacement</em>, <em>vb=None</em>, <em>nb=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Displacement" title="Permalink to this definition">¶</a></dt>
<dd><p>A diffeomorphism ψ mapping from a population space <span class="math notranslate nohighlight">\(M\)</span> to a
subject space $R$. Here, it is</p>
<div class="math notranslate nohighlight">
\[ψ (x) = x + δ(x).\]</div>
<p>for a displacement field <span class="math notranslate nohighlight">\(δ\)</span>.</p>
<p>A point [i,j,k] in the index space of the template of <span class="math notranslate nohighlight">\(M\)</span> maps
to the coordinates</p>
<div class="math notranslate nohighlight">
\[ψ(reference[i,j,k]) = reference[i,j,k] + displacement[i,j,k]\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reference</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a><em> or </em><em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>4</em><em>,</em><em>4</em><em>)</em>) – An affine transformation.</li>
<li><strong>displacement</strong> (<em>ndarray</em><em> (</em><em>?</em><em>,</em><em>?</em><em>,</em><em>?</em><em>,</em><em>3</em><em>)</em>) – A displacement field</li>
<li><strong>vb</strong> (<em>str</em><em> or </em><em>Identifier</em>) – An object that will be used to identify the domain (vb) of this
diffeomorphism.</li>
<li><strong>nb</strong> (<em>str</em><em> or </em><em>Identifier</em>) – An object that will be used to identify the image (nb) of this
diffeomorphism.</li>
<li><strong>metadata</strong> (<em>dict</em>) – If meta data is provided which give information on which data
had been used for the fit: which had provided, should be a dict
with at least the following fields: <code class="docutils literal notranslate"><span class="pre">{'vb_file':</span>
<span class="pre">path/which/defined/the/domain,</span> <span class="pre">'nb_file':</span>
<span class="pre">path/which/defined/the/image,}</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fmristats.diffeomorphisms.Displacement.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>coordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Displacement.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the point at given coordinate</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of integers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>There are interpolations at place here, which makes this
potentially slow for large queries.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Displacement.apply_to_index">
<code class="descname">apply_to_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Displacement.apply_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the point with given index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of integers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Displacement.apply_to_indices">
<code class="descname">apply_to_indices</code><span class="sig-paren">(</span><em>indices</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Displacement.apply_to_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the points with given indices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of slices or ellipses</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fmristats.diffeomorphisms.Identity">
<em class="property">class </em><code class="descclassname">fmristats.diffeomorphisms.</code><code class="descname">Identity</code><span class="sig-paren">(</span><em>reference</em>, <em>shape</em>, <em>vb=None</em>, <em>nb=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Identity" title="Permalink to this definition">¶</a></dt>
<dd><p>The identity diffeomorphism ψ.</p>
<dl class="method">
<dt id="fmristats.diffeomorphisms.Identity.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>coordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Identity.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the point at given coordinate</p>
<p>This is the identity; it will return the same coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of integers.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Identity.apply_to_index">
<code class="descname">apply_to_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Identity.apply_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the point with given index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of integers.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Identity.apply_to_indices">
<code class="descname">apply_to_indices</code><span class="sig-paren">(</span><em>indices</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Identity.apply_to_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the points with given indices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of slices or ellipses.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fmristats.diffeomorphisms.Image">
<em class="property">class </em><code class="descclassname">fmristats.diffeomorphisms.</code><code class="descname">Image</code><span class="sig-paren">(</span><em>reference</em>, <em>data</em>, <em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds all information of a 3D-image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reference</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a><em> or </em><em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>4</em><em>,</em><em>4</em><em>)</em>) – An affine transformation that maps indices in the data
array to coordinates in Euclidean space.</li>
<li><strong>data</strong> (<em>np.ndarray</em>) – The data array.</li>
<li><strong>name</strong> (<em>str</em><em> or </em><em>Identifier</em>) – An identifier or name for this image.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.components">
<code class="descname">components</code><span class="sig-paren">(</span><em>threshold</em>, <em>component_size=None</em>, <em>direction='lower'</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.components" title="Permalink to this definition">¶</a></dt>
<dd><p>Components of an image</p>
<p>Enumerates (more precisely: labels) the components above or below
the given threshold in the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>threshold</strong> (<em>float</em>) – The threshold</li>
<li><strong>component_size</strong> (<em>float</em>) – Minimal volume for a component to be labelled</li>
<li><strong>direction</strong> (<em>str</em><em>, </em><em>'lower'</em><em> or </em><em>'upper'</em>) – Direction of the cut. Default is ‘lower’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>labelled</strong> (<em>Image</em>) – The labelled image</li>
<li><strong>labels</strong> (<em>list</em>) – The labels in the image</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Please note that the <cite>component_size</cite> is expected to be given in
mm^3 and <strong>not</strong> as the number of voxels.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.describe">
<code class="descname">describe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.describe" title="Permalink to this definition">¶</a></dt>
<dd><p>Describe the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.detect_peaks">
<code class="descname">detect_peaks</code><span class="sig-paren">(</span><em>connectivity=3</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.detect_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Detects the peaks in an image</p>
<p>Takes an image and detect the peaks using a local maximum
filter. Returns a boolean mask of the peaks (i.e. 1 when the
pixel’s value is the neighbourhood of a maximum and 0 otherwise)</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.flatten">
<code class="descname">flatten</code><span class="sig-paren">(</span><em>epi_code</em>, <em>xpic</em>, <em>ypic</em>, <em>slices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Flatten a 3D image into a 2D image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>epi_code</strong> (<em>int</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Flattens by slicing the 3D image along the axis of the respected
EPI code, and stack the slices into a xpic x ypic matrix</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.get_mask">
<code class="descname">get_mask</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.get_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a mask</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">boolean array which is <em>True</em> whenever values in the data are
<em>valid</em>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray, dtype(bool)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.mask">
<code class="descname">mask</code><span class="sig-paren">(</span><em>mask=None</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Mask the data array by mask</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mask</strong> (<em>ndarray</em><em>, </em><em>dtype</em><em>(</em><em>bool</em><em>)</em>) – An array of bool indicating the foreground</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The same image but with data set to nan outside the mask</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image">Image</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.mean">
<code class="descname">mean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean value in the image</p>
<p class="rubric">Notes</p>
<p>Values of 0 or nan will not contribute to the mean signal.  If
your image <code class="docutils literal notranslate"><span class="pre">img</span></code> contains 0 values, then <code class="docutils literal notranslate"><span class="pre">im.data.mean()</span></code>
and <code class="docutils literal notranslate"><span class="pre">im.mean()</span></code> will differ and this is intended.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>float</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">mean value of the image</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.range">
<code class="descname">range</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.range" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the range of values in the image</p>
<p class="rubric">Notes</p>
<p>Values of 0 or nan will not contribute to the range.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>tuple</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(minimum, maximum)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.ravel">
<code class="descname">ravel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.ravel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a contiguous flattened array of the image</p>
<p>A 1-D array, containing the non-null, and non-nan elements of
the input, is returned. Array is a copy of the data.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.round">
<code class="descname">round</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.round" title="Permalink to this definition">¶</a></dt>
<dd><p>Round data in the image to integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image">Image</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save instance to disk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – A file name.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Image.volume">
<code class="descname">volume</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Image.volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the volume occupied by the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>float</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">volume of non-zero values in the image</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fmristats.diffeomorphisms.Warp">
<em class="property">class </em><code class="descclassname">fmristats.diffeomorphisms.</code><code class="descname">Warp</code><span class="sig-paren">(</span><em>reference</em>, <em>warp</em>, <em>vb=None</em>, <em>nb=None</em>, <em>name=None</em>, <em>metadata=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Warp" title="Permalink to this definition">¶</a></dt>
<dd><p>A diffeomorphism ψ mapping from a population space <span class="math notranslate nohighlight">\(M\)</span> to a
subject space $R$. Here, it is</p>
<div class="math notranslate nohighlight">
\[ψ (x) = δ(x).\]</div>
<p>for a warp field <span class="math notranslate nohighlight">\(δ\)</span>.</p>
<p>A point [i,j,k] in the index space of the template of <span class="math notranslate nohighlight">\(M\)</span> maps
to the coordinates</p>
<div class="math notranslate nohighlight">
\[ψ(reference[i,j,k]) = warp[i,j,k]\]</div>
<p>An example: The FSL FNIRT warp coefficients file is saved as a Warp
instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>reference</strong> (<a class="reference internal" href="#fmristats.affines.Affine" title="fmristats.affines.Affine"><em>Affine</em></a><em> or </em><em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>4</em><em>,</em><em>4</em><em>)</em>) – An affine transformation</li>
<li><strong>warp</strong> (<em>ndarray</em><em> (</em><em>..</em><em>,</em><em>3</em><em>)</em>) – A warp field</li>
<li><strong>vb</strong> (<em>str</em><em> or </em><em>Identifier</em>) – An object that will be used to identify the domain (vb) of this
diffeomorphism.</li>
<li><strong>nb</strong> (<em>str</em><em> or </em><em>Identifier</em>) – An object that will be used to identify the image (nb) of this
diffeomorphism.</li>
<li><strong>metadata</strong> (<em>dict</em>) – If meta data is provided which give information on which data
had been used for the fit: which had provided, should be a dict
with at least the following fields: <code class="docutils literal notranslate"><span class="pre">{'vb_file':</span>
<span class="pre">path/which/defined/the/domain,</span> <span class="pre">'nb_file':</span>
<span class="pre">path/which/defined/the/image,}</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fmristats.diffeomorphisms.Warp.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>coordinates</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Warp.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the point at given coordinate</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of integers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>There are interpolations at place here, which makes this
potentially slow for large queries.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Warp.apply_to_index">
<code class="descname">apply_to_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Warp.apply_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the point with given index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of integers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.diffeomorphisms.Warp.apply_to_indices">
<code class="descname">apply_to_indices</code><span class="sig-paren">(</span><em>indices</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.diffeomorphisms.Warp.apply_to_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply diffeomorphism to the points with given indices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – Should be a tuple of slices or ellipses</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fmristats.smodel">
<span id="the-fmri-signal-model"></span><h2>The FMRI Signal Model<a class="headerlink" href="#module-fmristats.smodel" title="Permalink to this headline">¶</a></h2>
<p>Defines a class for the FMRI signal model and its fits.</p>
<dl class="class">
<dt id="fmristats.smodel.Result">
<em class="property">class </em><code class="descclassname">fmristats.smodel.</code><code class="descname">Result</code><span class="sig-paren">(</span><em>coordinates</em>, <em>statistics</em>, <em>population_map</em>, <em>hyperparameters</em>, <em>parameter_dict</em>, <em>value_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.Result" title="Permalink to this definition">¶</a></dt>
<dd><p>Result of a FMRI fitting</p>
<p>Defines a class for the result, i.e., the estimated effect field of
an FMRI experiments, fitted by the function attribute of the <cite>FMRI</cite>
class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>Identifier</em>) – An identifier</li>
<li><strong>population_map</strong> (<a class="reference internal" href="#fmristats.pmap.PopulationMap" title="fmristats.pmap.PopulationMap"><em>PopulationMap</em></a>) – </li>
<li><strong>field</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>…</em><em>,</em><em>3</em><em>)</em><em>, </em><em>dtype: float</em>) – The effect or fitted model parameter field</li>
<li><strong>coordinates</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>…</em><em>,</em><em>3</em><em>)</em><em>, </em><em>dtype: float</em>) – </li>
<li><strong>hyperparameters</strong> (<em>dict</em>) – </li>
<li><strong>parameters</strong> (<em>dict {str: int}</em>) – The names of the parameters which have been fitted by the
signal model in the order of appearance in the model.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fmristats.smodel.Result.get_field">
<code class="descname">get_field</code><span class="sig-paren">(</span><em>param</em>, <em>value=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.Result.get_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract scalar field</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>param</strong> (<em>str</em>) – Check the attribute parameter_dict for possible values of
<cite>param</cite>.</li>
<li><strong>value</strong> (<em>str</em>) – Check the attribute value_dict for possible values of
<cite>value</cite>. Note that ‘tstatistic’ is also valid and will be
calculated from the key point and stderr.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The queried field</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image">Image</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>It only makes sense to combine intercept or activation
with point, stderr, and tstatistic, and it only makes sense to
combine other with mse (an estimate of sigma-squared) or df
(residual degrees of freedom)</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.Result.mask">
<code class="descname">mask</code><span class="sig-paren">(</span><em>mask=True</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.Result.mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply mask to parameter fields</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.Result.norm_to">
<code class="descname">norm_to</code><span class="sig-paren">(</span><em>rf</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.Result.norm_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Norm the part of the statistics field that has a unit, to a
reference field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rf</strong> (<a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a>) – The reference field for the unit.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.Result.norm_to_ati">
<code class="descname">norm_to_ati</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.Result.norm_to_ati" title="Permalink to this definition">¶</a></dt>
<dd><p>Norm the part of the statistics field that has a unit, to the
ati-reference field that is stored in the PopulationMap.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.Result.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.Result.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save instance to disk</p>
<p>This will save the current instance to disk for later use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – File name.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fmristats.smodel.SignalFit">
<em class="property">class </em><code class="descclassname">fmristats.smodel.</code><code class="descname">SignalFit</code><span class="sig-paren">(</span><em>coordinates</em>, <em>params</em>, <em>cov_params</em>, <em>mse</em>, <em>population_map</em>, <em>hyperparameters</em>, <em>parameter_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalFit" title="Permalink to this definition">¶</a></dt>
<dd><p>Result of a FMRI fitting</p>
<p>Defines a class for the result, i.e., the estimated effect field of
an FMRI experiments, fitted by the function attribute of the <cite>FMRI</cite>
class.</p>
<dl class="method">
<dt id="fmristats.smodel.SignalFit.get_field">
<code class="descname">get_field</code><span class="sig-paren">(</span><em>parameter</em>, <em>value=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalFit.get_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the scalar field for the parameter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>parameter</strong> (<em>int</em><em> or </em><em>str</em><em> or </em><em>list</em><em>(</em><em>int</em><em>) or </em><em>np.array</em>) – Must int or a key in the parameter_dict.</li>
<li><strong>value</strong> (<em>str</em>) – The value string can be either point, stderr, or tstatistic.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The queried field</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image">Image</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The parameter_dict can either contain the position of a
parameter in the parameter field or a contrast of parameters in
the field. The form can either be a single integer, a list of
integers or an arrays. Example: {‘intercept’ : 0,
‘bold_contrast’ : [0,1,0,-1,0,0,0,0,0]}</p>
<p>The counting starts at 0, hence 0 is the first parameter (and
typically the intercept), 1 is the second parameter in the
design matrix (and typically the first non-constant parameter),
and so on.</p>
<p>The value string can be either point, stderr, or tstatistic.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalFit.mask">
<code class="descname">mask</code><span class="sig-paren">(</span><em>mask=True</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalFit.mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply mask to parameter fields</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalFit.norm_to">
<code class="descname">norm_to</code><span class="sig-paren">(</span><em>reference_field</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalFit.norm_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Norm the part of the statistics field that has a unit, to a
reference field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>reference_field</strong> (<a class="reference internal" href="#fmristats.diffeomorphisms.Image" title="fmristats.diffeomorphisms.Image"><em>Image</em></a>) – The reference field for the unit.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalFit.norm_to_ati">
<code class="descname">norm_to_ati</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalFit.norm_to_ati" title="Permalink to this definition">¶</a></dt>
<dd><p>Norm the part of the statistics field that has a unit, to the
ati-reference field that is stored in the PopulationMap.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalFit.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalFit.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save instance to disk</p>
<p>This will save the current instance to disk for later use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – File name.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fmristats.smodel.SignalModel">
<em class="property">class </em><code class="descclassname">fmristats.smodel.</code><code class="descname">SignalModel</code><span class="sig-paren">(</span><em>session, reference_maps, population_map, formula='C(task)/C(block, Sum)', parameter=['intercept', 'task']</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel" title="Permalink to this definition">¶</a></dt>
<dd><p>The signal model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>session</strong> (<a class="reference internal" href="#fmristats.session.Session" title="fmristats.session.Session"><em>Session</em></a>) – A session (with fitted foreground).</li>
<li><strong>reference_maps</strong> (<a class="reference internal" href="#fmristats.reference.ReferenceMaps" title="fmristats.reference.ReferenceMaps"><em>ReferenceMaps</em></a>) – The estimated reference maps.</li>
<li><strong>population_map</strong> (<a class="reference internal" href="#fmristats.pmap.PopulationMap" title="fmristats.pmap.PopulationMap"><em>PopulationMap</em></a>) – A population map</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fmristats.smodel.SignalModel.coordinates">
<code class="descname">coordinates</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>The coordinate grid of observations</p>
<p>The coordinates in subject reference space of all points at
which MR signals have been acquired.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ndarray, shape (n,x,y,z,3), dtype</strong> – […,:3] = coordinates of observation</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.data_at_coordinate">
<code class="descname">data_at_coordinate</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.data_at_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given
with respect to the coordinate system of the subject reference
space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.data_at_index">
<code class="descname">data_at_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.data_at_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given
with respect to the coordinate system of the subject reference
space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.data_at_subject_coordinate">
<code class="descname">data_at_subject_coordinate</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.data_at_subject_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given
with respect to the coordinate system of the subject reference
space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.design_AT_coordinate">
<code class="descname">design_AT_coordinate</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.design_AT_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given
with respect to the coordinate system of the subject reference
space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.design_AT_index">
<code class="descname">design_AT_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.design_AT_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given
with respect to the coordinate system of the subject reference
space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.design_AT_subject_coordinate">
<code class="descname">design_AT_subject_coordinate</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.design_AT_subject_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given
with respect to the coordinate system of the subject reference
space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>mask=True</em>, <em>verbose=True</em>, <em>backend='numba'</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mask</strong> (<em>None</em><em> or </em><em>bool</em><em> or </em><em>str</em><em> or </em><em>ndarray</em><em>, </em><em>dtype: bool</em>) – string can be one of ‘vb’, ‘vb_background’,
‘foreground’, or ‘vb_estimate’. None defaults to ‘data’. True will
take precedence: ‘vb’&gt; ‘vb_background’&gt; ‘vb_estimate’ &gt;
‘foreground’.</li>
<li><strong>verbose</strong> (<em>bool</em>) – increase output verbosity</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Result</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Fitted field.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.fit_AT_coordinate">
<code class="descname">fit_AT_coordinate</code><span class="sig-paren">(</span><em>x</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.fit_AT_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given with
respect to the coordinate system of the population space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.fit_AT_index">
<code class="descname">fit_AT_index</code><span class="sig-paren">(</span><em>index</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.fit_AT_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – The index at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.fit_AT_subject_coordinate">
<code class="descname">fit_AT_subject_coordinate</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.fit_AT_subject_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given
with respect to the coordinate system of the subject reference
space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</li>
<li><strong>formula</strong> (<em>str</em>) – A formula.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.fit_at_coordinate">
<code class="descname">fit_at_coordinate</code><span class="sig-paren">(</span><em>x</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.fit_at_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given with
respect to the coordinate system of the population space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.fit_at_index">
<code class="descname">fit_at_index</code><span class="sig-paren">(</span><em>index</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.fit_at_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – The index at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.fit_at_subject_coordinate">
<code class="descname">fit_at_subject_coordinate</code><span class="sig-paren">(</span><em>x</em>, <em>formula=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.fit_at_subject_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given
with respect to the coordinate system of the subject reference
space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</li>
<li><strong>formula</strong> (<em>str</em>) – A formula.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.fit_at_subject_coordinates">
<code class="descname">fit_at_subject_coordinates</code><span class="sig-paren">(</span><em>coordinates</em>, <em>mask=None</em>, <em>verbose=True</em>, <em>backend='numba'</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.fit_at_subject_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>coordinates</strong> (<em>None</em><em> or </em><em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>…</em><em>,</em><em>3</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</li>
<li><strong>verbose</strong> (<em>bool</em>) – increase output verbosity</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#fmristats.smodel.Result" title="fmristats.smodel.Result">Result</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.get_mask">
<code class="descname">get_mask</code><span class="sig-paren">(</span><em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.get_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a data mask</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.get_observations">
<code class="descname">get_observations</code><span class="sig-paren">(</span><em>include_background=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.get_observations" title="Permalink to this definition">¶</a></dt>
<dd><p>Observation matrix</p>
<p>Returns the array of (un-cleaned) observations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ndarray, shape (n,x,y,z,9), dtype</strong> – […,:3] = coordinates of observation
[…, 3] = MR signal response
[…, 4] = time of observation
[…, 5] = task during time of observation
[…, 6] = block number during time of observation
[…, 7] = scan cycle
[…, 8] = slice number</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.get_roi">
<code class="descname">get_roi</code><span class="sig-paren">(</span><em>mask=True</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.get_roi" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates and mask</p>
<p>Combines the data mask with other masks to produce a suitable
mask for fitting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mask</strong> (<em>None</em><em> or </em><em>bool</em><em> or </em><em>str</em><em> or </em><em>ndarray</em><em>, </em><em>dtype: bool</em>) – Either one of ‘vb_mask’, ‘vb’, ‘vb_background’,
‘foreground’, or ‘vb_estimate’. If None defaults to ‘data’.
True will take precedence: ‘vb_mask’ &gt; ‘vb’ &gt;
‘vb_background’&gt; ‘vb_estimate’ &gt; ‘foreground’.</li>
<li><strong>verbose</strong> (<em>bool</em>) – Increase output verbosity</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>coordinates</strong> (<em>ndarray, dtype: float</em>) – Coordinates in standard space.</li>
<li><strong>mask</strong> (<em>ndarray, dtype: bool</em>) – Mask in standard space. True when within a ROI.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.mean_index_affine">
<code class="descname">mean_index_affine</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.mean_index_affine" title="Permalink to this definition">¶</a></dt>
<dd><p>Affine transformation from reference space to the index space of
the acquisition grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>Affine</strong> (<em>The affine transformation that maps a coordinate in</em>)</li>
<li><em>reference space to the mean index in the index space of the</em></li>
<li><em>acquisition grid of the session.</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.model_AT_coordinate">
<code class="descname">model_AT_coordinate</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.model_AT_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given with
respect to the coordinate system of the population space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.model_AT_index">
<code class="descname">model_AT_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.model_AT_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – The index at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.model_AT_subject_coordinate">
<code class="descname">model_AT_subject_coordinate</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.model_AT_subject_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given
with respect to the coordinate system of the subject reference
space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</li>
<li><strong>formula</strong> (<em>str</em>) – A formula.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.model_at_coordinate">
<code class="descname">model_at_coordinate</code><span class="sig-paren">(</span><em>x</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.model_at_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given with
respect to the coordinate system of the population space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.model_at_index">
<code class="descname">model_at_index</code><span class="sig-paren">(</span><em>index</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.model_at_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em>) – The index at which to fit the model</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.model_at_subject_coordinate">
<code class="descname">model_at_subject_coordinate</code><span class="sig-paren">(</span><em>x</em>, <em>formula=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.model_at_subject_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the signal model to data at specified coordinates given
with respect to the coordinate system of the subject reference
space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>,</em><em>)</em><em>, </em><em>dtype: float</em>) – The coordinates at which to fit the model</li>
<li><strong>formula</strong> (<em>str</em>) – A formula.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save instance to disk</p>
<p>This will save the current instance to disk for later use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – File name.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.set_data">
<code class="descname">set_data</code><span class="sig-paren">(</span><em>burn_in=4</em>, <em>demean=False</em>, <em>dropna=True</em>, <em>include_background=False</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.set_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the observation matrix</p>
<p>This will set the attributes .observations, .valid, .data, and
.dataframe.</p>
<p class="rubric">Notes</p>
<p>The observations are an array of the following shape:</p>
<blockquote>
<div><dl class="docutils">
<dt>ndarray, shape (n,x,y,z,9), dtype: float</dt>
<dd>[…,:3] = coordinates of observation
[…, 3] = the MR signal response
[…, 4] = time of observation
[…, 5] = task during time of observation
[…, 6] = block number during time of observation
[…, 7] = scan cycle
[…, 8] = slice number</dd>
</dl>
</div></blockquote>
<p>The data in this array are the basis of all model fits.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.set_design">
<code class="descname">set_design</code><span class="sig-paren">(</span><em>formula=None</em>, <em>parameter=None</em>, <em>return_design_matrix=False</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.set_design" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or create the design matrix</p>
<p>This will set the attribute .design, and it will overwrite the
attributes .valid, .data, .dataframe, and potentially .formula,
and .parameter_dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>design</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>m</em><em>,</em><em>n</em><em>,</em><em>x</em><em>,</em><em>y</em><em>,</em><em>z</em><em>,</em><em>p</em><em>) or </em><em>(</em><em>m</em><em>,</em><em>n</em><em>,</em><em>p</em><em>) or </em><em>(</em><em>m</em><em>,</em><em>p</em><em>)</em>) – Design matrix for the m scan cycles with n scans per cycle
on the grid x, y, z with p number of parameters</li>
<li><strong>formula</strong> (<em>None</em><em> or </em><em>str</em>) – If X is None, this formula will be used to create the design
matrix. If formula is None, the default stored in .formula
will be used. Otherwise .formula will be overwritten</li>
<li><strong>parameter</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – A list of parameter names</li>
<li><strong>return_design_matrix</strong> (<em>bool</em>) – If True, return the design matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">None or DesignMatrix</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.set_design_to">
<code class="descname">set_design_to</code><span class="sig-paren">(</span><em>design</em>, <em>hasconst</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.set_design_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or create the design matrix</p>
<p>This will set the attribute .design.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>design</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>m</em><em>,</em><em>n</em><em>,</em><em>x</em><em>,</em><em>y</em><em>,</em><em>z</em><em>,</em><em>p</em><em>) or </em><em>(</em><em>m</em><em>,</em><em>n</em><em>,</em><em>p</em><em>) or </em><em>(</em><em>m</em><em>,</em><em>p</em><em>)</em>) – Design matrix for the m scan cycles with n scans per cycle
on the grid x, y, z with p number of parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.set_hyperparameters">
<code class="descname">set_hyperparameters</code><span class="sig-paren">(</span><em>scale_type='max'</em>, <em>factor=3</em>, <em>scale=None</em>, <em>mass=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.set_hyperparameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the hyperparameter for MB estimation</p>
<p>Set the width of the spatial weighting scheme for MB
estimation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>scale_type</strong> (<em>str</em>) – One of min, max (default), diagonal</li>
<li><strong>scale</strong> (<em>None</em><em> or </em><em>float</em>) – Standard deviation of the Gaussian used to weight
observations with respect to distance to point.</li>
<li><strong>factor</strong> (<em>float</em>) – Controls the centre mass of the Gaussian used to weight
observations with respect to distance to point.</li>
<li><strong>mass</strong> (<em>None</em><em> or </em><em>float</em><em> (</em><em>optional</em><em>)</em>) – Centre mass of the Gaussian used to weight
observations with respect to distance to point.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The only hyperparameter you need to set is <cite>scale</cite>, which is set
for you if you set the scale_type.</p>
<p>Factor takes precedence to mass, as I will assume if you are
setting the mass, you know what you are doing.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.smodel.SignalModel.set_stimulus_design">
<code class="descname">set_stimulus_design</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.smodel.SignalModel.set_stimulus_design" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and set the stimulus design of the session</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fmristats.sample">
<span id="the-sample"></span><h2>The Sample<a class="headerlink" href="#module-fmristats.sample" title="Permalink to this headline">¶</a></h2>
<p>Sample</p>
<dl class="class">
<dt id="fmristats.sample.Sample">
<em class="property">class </em><code class="descclassname">fmristats.sample.</code><code class="descname">Sample</code><span class="sig-paren">(</span><em>covariates</em>, <em>statistics</em>, <em>study</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.sample.Sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampled activation fields of a FMRI study</p>
<dl class="method">
<dt id="fmristats.sample.Sample.at_index">
<code class="descname">at_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.sample.Sample.at_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the summary statistics at an index</p>
<p>Returns the effect and respective standard error of all subjects
in the sample.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<em>tuple</em><em>(</em><em>int</em><em>)</em>) – The index. A 3-tuple of integers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.sample.Sample.filter">
<code class="descname">filter</code><span class="sig-paren">(</span><em>b=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.sample.Sample.filter" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<p>Here, b should be a slice object, you cannot work with the index
of the covariate data frame, but must use integer location
indices instead.</p>
</dd></dl>

<dl class="method">
<dt id="fmristats.sample.Sample.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.sample.Sample.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model instance to disk</p>
<p>This will save the current model instance to disk for later use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – File name.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fmristats.pmodel">
<span id="the-fmri-population-model"></span><h2>The FMRI Population Model<a class="headerlink" href="#module-fmristats.pmodel" title="Permalink to this headline">¶</a></h2>
<p>Defines a class for the FMRI population model and its fits.</p>
<dl class="class">
<dt id="fmristats.pmodel.PopulationModel">
<em class="property">class </em><code class="descclassname">fmristats.pmodel.</code><code class="descname">PopulationModel</code><span class="sig-paren">(</span><em>sample</em>, <em>formula=None</em>, <em>design=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmodel.PopulationModel" title="Permalink to this definition">¶</a></dt>
<dd><p>The FMRI population model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sample</strong> (<a class="reference internal" href="#fmristats.sample.Sample" title="fmristats.sample.Sample"><em>Sample</em></a>) – </li>
<li><strong>formula</strong> (<em>str</em>) – A formula like object that is understood by patsy.</li>
<li><strong>design</strong> (<em>ndarray</em>) – If None, will be created from formula
Directly specifying a design matrix, i.e., providing design
will take precedence from the formula interface.</li>
<li><strong>mask</strong> (<em>None</em><em>, </em><em>bool</em><em>, </em><em>ndarray</em><em>, or </em><em>str</em>) – If False or None, the population model will be fitted only
at points, at which the population model is identifiable.
If True or ‘template’, the population model will,
additionally, only be fitted at points, at which the
template in the population has valid intensities (i.e. &gt; 0
and not NAN). If ‘sample’, the population model will be
fitted only at points at which the sample provides valid
summary statistics for <em>all</em> fields in the sample.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="fmristats.pmodel.PopulationModel.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>mask=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmodel.PopulationModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model to the data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">PopulationResult</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fmristats.pmodel.PopulationModel.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#fmristats.pmodel.PopulationModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model instance to disk</p>
<p>This will save the current model instance to disk for later use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – File name.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="new.html" class="btn btn-neutral float-right" title="What is new" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorials/notes.html" class="btn btn-neutral" title="Some notes on speed" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2018, Thomas W. D. Möbius

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'0.1.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>